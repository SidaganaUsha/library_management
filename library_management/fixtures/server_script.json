[
 {
  "allow_guest": 0,
  "api_method": null,
  "cron_format": null,
  "disabled": 0,
  "docstatus": 0,
  "doctype": "Server Script",
  "doctype_event": "Before Save",
  "enable_rate_limit": 0,
  "event_frequency": "All",
  "modified": "2025-06-09 12:36:49.886241",
  "module": "library_management",
  "name": "Changing the Status is Returned if Article is Returned in Library Transaction",
  "rate_limit_count": 5,
  "rate_limit_seconds": 86400,
  "reference_doctype": "Library Transaction",
  "script": "# setting the Status from Issued to Returned in Library Transaction Doctype when the Article is Returned\n\nif doc.return_date and doc.status == \"Issued\":\n    doc.status = \"Returned\"",
  "script_type": "DocType Event"
 },
 {
  "allow_guest": 0,
  "api_method": null,
  "cron_format": null,
  "disabled": 0,
  "docstatus": 0,
  "doctype": "Server Script",
  "doctype_event": "Before Save",
  "enable_rate_limit": 0,
  "event_frequency": "All",
  "modified": "2025-06-09 14:58:21.801875",
  "module": "library_management",
  "name": "Set Article status to Available if Return Date is set in Library Transaction",
  "rate_limit_count": 5,
  "rate_limit_seconds": 86400,
  "reference_doctype": "Library Transaction",
  "script": "if doc.return_date:\n    article = frappe.get_doc(\"Article\", doc.article)\n    if article.status == \"Issued\":\n        article.status = \"Available\"\n        article.save()\n\n\nelif doc.status == \"Issued\":\n    article = frappe.get_doc(\"Article\", doc.article)\n    if article.status != \"Issued\":\n        article.status = \"Issued\"\n        article.save()",
  "script_type": "DocType Event"
 },
 {
  "allow_guest": 0,
  "api_method": null,
  "cron_format": null,
  "disabled": 0,
  "docstatus": 0,
  "doctype": "Server Script",
  "doctype_event": "Before Save",
  "enable_rate_limit": 0,
  "event_frequency": "All",
  "modified": "2025-06-09 15:06:00.299893",
  "module": "library_management",
  "name": "Do not allow saving a Library Transaction if the linked Article status is Issued",
  "rate_limit_count": 5,
  "rate_limit_seconds": 86400,
  "reference_doctype": "Library Transaction",
  "script": "if doc.status == \"Issued\":\n    article = frappe.get_doc(\"Article\", doc.article)\n\n    # Check if the article is already issued AND it's issued by a different transaction\n    existing_txn = frappe.get_all(\n        \"Library Transaction\",\n        filters={\n            \"article\": doc.article,\n            \"status\": \"Issued\",\n            \"name\": [\"!=\", doc.name]  # Exclude the current document\n        },\n        limit=1\n    )\n\n    if existing_txn:\n        frappe.throw(f\"The Article '{article.name}' is already issued to someone.\")\n",
  "script_type": "DocType Event"
 }
]